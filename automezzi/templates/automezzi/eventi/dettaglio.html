{% extends "base.html" %}
{% block title %}Dettaglio evento{% endblock %}

{% block content %}
<div class="container py-4">
  <h4 class="mb-4">
    <i class="fas fa-exclamation-triangle"></i> Dettaglio evento {{ evento.get_tipo_display }} – {{ evento.automezzo.targa }}
  </h4>
  <table class="table table-bordered w-auto">
    <tr>
      <th>Tipo</th>
      <td>{{ evento.get_tipo_display }}</td>
    </tr>
    <tr>
      <th>Data evento</th>
      <td>{{ evento.data_evento|date:"d/m/Y" }}</td>
    </tr>
    <tr>
      <th>Chilometri</th>
      <td>{{ evento.chilometri|default:"—" }}</td>
    </tr>
    <tr>
      <th>Descrizione</th>
      <td>{{ evento.descrizione }}</td>
    </tr>
    <tr>
      <th>Costo</th>
      <td>{{ evento.costo|floatformat:2 }} €</td>
    </tr>
    <tr>
      <th>Risolto</th>
      <td>
        {% if evento.risolto %}
          <span class="badge bg-success">Sì</span>
        {% else %}
          <span class="badge bg-warning text-dark">No</span>
        {% endif %}
      </td>
    </tr>
    <tr>
      <th>Note</th>
      <td>{{ evento.note|default:"—" }}</td>
    </tr>
    <tr>
      <th>Dipendente coinvolto</th>
      <td>{{ evento.dipendente_coinvolto.get_full_name|default:"—" }}</td>
    </tr>
    <tr>
      <th>File allegato</th>
      <td>
        {% if evento.file_allegato %}
          <a href="{{ evento.file_allegato.url }}" target="_blank">
            {{ evento.file_allegato.name|basename }}
          </a>
        {% else %}
          <span class="text-muted">—</span>
        {% endif %}
      </td>
    </tr>
    <tr>
      <th>Creato il</th>
      <td>{{ evento.created_at|date:"d/m/Y H:i" }}</td>
    </tr>
    <tr>
      <th>Ultima modifica</th>
      <td>{{ evento.updated_at|date:"d/m/Y H:i" }}</td>
    </tr>
  </table>
  <div class="mt-3">
    <a href="{% url 'automezzi:modifica_evento' automezzo_pk=evento.automezzo.pk pk=evento.pk %}" class="btn btn-info">
      <i class="fas fa-edit"></i> Modifica
    </a>
    {% if not evento.risolto %}
      <a href="{% url 'automezzi:risolvi_evento' pk=evento.pk %}" class="btn btn-warning ms-2">
        <i class="fas fa-check"></i> Marca come risolto
      </a>
    {% endif %}
    <a href="{% url 'automezzi:dettaglio' evento.automezzo.pk %}?sezione=eventi" class="btn btn-secondary ms-2">
      Torna agli eventi
    </a>
  </div>
</div>
{% endblock %}